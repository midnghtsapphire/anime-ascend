import { useState } from 'react';\nimport { useAuth } from '@/contexts/AuthContext';\nimport { useAccessibility } from '@/contexts/AccessibilityContext';\nimport { useBilling } from '@/contexts/BillingContext';\nimport { Button } from '@/components/ui/button';\nimport { Card } from '@/components/ui/card';\nimport { Input } from '@/components/ui/input';\nimport { Label } from '@/components/ui/label';\nimport { Switch } from '@/components/ui/switch';\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs';\nimport { Settings as SettingsIcon, Lock, Bell, Accessibility } from 'lucide-react';\nimport { AccessibilitySettings } from '@/components/AccessibilitySettings';\n\n/**\n * Anime Ascend Settings Page\n * Design: Neon Shrine glassmorphism\n * \n * Features:\n * - Account settings\n * - Accessibility modes\n * - Notification preferences\n * - Billing and subscription\n * - Privacy and security\n */\n\nexport default function Settings() {\n  const { user, logout } = useAuth();\n  const { isEnabled } = useAccessibility();\n  const { billing, cancelSubscription } = useBilling();\n  const [showA11ySettings, setShowA11ySettings] = useState(false);\n  const [accountForm, setAccountForm] = useState({ name: '', email: '' });\n  const [notificationPrefs, setNotificationPrefs] = useState({\n    emailNotifications: true,\n    newAnimeAlerts: true,\n    recommendationEmails: false,\n    billingAlerts: true,\n  });\n\n  if (!user) {\n    return (\n      <div className=\"min-h-screen bg-background text-foreground flex items-center justify-center\">\n        <p className=\"text-foreground/70\">Please log in to access settings</p>\n      </div>\n    );\n  }\n\n  const handleLogout = async () => {\n    await logout();\n    window.location.href = '/';\n  };\n\n  return (\n    <div className=\"min-h-screen bg-background text-foreground\">\n      {/* Navigation */}\n      <nav className=\"sticky top-0 z-50 glass-panel-sm backdrop-blur-xl border-b border-primary/20\">\n        <div className=\"container flex items-center justify-between h-16\">\n          <div className=\"flex items-center gap-3\">\n            <SettingsIcon className=\"w-6 h-6 text-primary\" />\n            <h1 className=\"text-2xl font-bold text-primary\">Settings</h1>\n          </div>\n        </div>\n      </nav>\n\n      {/* Main Content */}\n      <section className=\"container py-12 pb-24\">\n        <Tabs defaultValue=\"account\" className=\"w-full max-w-4xl\">\n          <TabsList className=\"glass-panel-sm mb-8 grid w-full grid-cols-4\">\n            <TabsTrigger value=\"account\">Account</TabsTrigger>\n            <TabsTrigger value=\"accessibility\">Accessibility</TabsTrigger>\n            <TabsTrigger value=\"notifications\">Notifications</TabsTrigger>\n            <TabsTrigger value=\"billing\">Billing</TabsTrigger>\n          </TabsList>\n\n          {/* Account Tab */}\n          <TabsContent value=\"account\" className=\"space-y-6\">\n            <Card className=\"glass-panel p-6\">\n              <h2 className=\"text-2xl font-bold mb-6\">Account Information</h2>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"name\" className=\"text-foreground/80\">\n                    Full Name\n                  </Label>\n                  <Input\n                    id=\"name\"\n                    type=\"text\"\n                    value={accountForm.name || user.name}\n                    onChange={(e) => setAccountForm({ ...accountForm, name: e.target.value })}\n                    className=\"mt-2 bg-background/50 border-primary/30 text-foreground\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"email\" className=\"text-foreground/80\">\n                    Email\n                  </Label>\n                  <Input\n                    id=\"email\"\n                    type=\"email\"\n                    value={accountForm.email || user.email}\n                    disabled\n                    className=\"mt-2 bg-background/50 border-primary/30 text-foreground/50\"\n                  />\n                </div>\n                <div>\n                  <Label className=\"text-foreground/80\">Account Type</Label>\n                  <div className=\"mt-2 p-3 bg-primary/10 rounded-lg border border-primary/20\">\n                    <p className=\"font-semibold text-primary capitalize\">{user.role}</p>\n                    <p className=\"text-sm text-foreground/60\">Tier: {user.subscriptionTier}</p>\n                  </div>\n                </div>\n                <Button className=\"w-full bg-primary hover:bg-primary/90 text-background\">\n                  Save Changes\n                </Button>\n              </div>\n            </Card>\n\n            {/* Password Section */}\n            <Card className=\"glass-panel p-6\">\n              <h3 className=\"text-lg font-bold mb-4 flex items-center gap-2\">\n                <Lock className=\"w-5 h-5\" />\n                Change Password\n              </h3>\n              <div className=\"space-y-4\">\n                <div>\n                  <Label htmlFor=\"current-password\" className=\"text-foreground/80\">\n                    Current Password\n                  </Label>\n                  <Input\n                    id=\"current-password\"\n                    type=\"password\"\n                    placeholder=\"••••••••\"\n                    className=\"mt-2 bg-background/50 border-primary/30 text-foreground placeholder:text-foreground/40\"\n                  />\n                </div>\n                <div>\n                  <Label htmlFor=\"new-password\" className=\"text-foreground/80\">\n                    New Password\n                  </Label>\n                  <Input\n                    id=\"new-password\"\n                    type=\"password\"\n                    placeholder=\"••••••••\"\n                    className=\"mt-2 bg-background/50 border-primary/30 text-foreground placeholder:text-foreground/40\"\n                  />\n                </div>\n                <Button className=\"w-full bg-primary hover:bg-primary/90 text-background\">\n                  Update Password\n                </Button>\n              </div>\n            </Card>\n\n            {/* Logout */}\n            <Card className=\"glass-panel p-6 border-red-500/30\">\n              <Button\n                onClick={handleLogout}\n                className=\"w-full bg-red-500/20 hover:bg-red-500/30 text-red-400 border border-red-500/50\"\n              >\n                Log Out\n              </Button>\n            </Card>\n          </TabsContent>\n\n          {/* Accessibility Tab */}\n          <TabsContent value=\"accessibility\">\n            <Card className=\"glass-panel p-6\">\n              <h2 className=\"text-2xl font-bold mb-6 flex items-center gap-2\">\n                <Accessibility className=\"w-6 h-6\" />\n                Accessibility Modes\n              </h2>\n              <p className=\"text-foreground/70 mb-6\">\n                Anime Ascend supports 5 mandatory accessibility modes to ensure everyone can enjoy the platform.\n              </p>\n              <Button\n                onClick={() => setShowA11ySettings(true)}\n                className=\"w-full bg-primary hover:bg-primary/90 text-background\"\n              >\n                Manage Accessibility Settings\n              </Button>\n              <AccessibilitySettings isOpen={showA11ySettings} onClose={() => setShowA11ySettings(false)} />\n\n              {/* Active Modes */}\n              <div className=\"mt-8\">\n                <h3 className=\"font-semibold mb-4\">Active Modes</h3>\n                <div className=\"grid grid-cols-2 gap-3\">\n                  {[\n                    { id: 'wcag-aaa', label: 'WCAG AAA' },\n                    { id: 'eco-code', label: 'ECO CODE' },\n                    { id: 'neuro-code', label: 'NEURO CODE' },\n                    { id: 'dyslexic', label: 'DYSLEXIC' },\n                    { id: 'no-blue-light', label: 'NO BLUE LIGHT' },\n                  ].map((mode) => (\n                    <div\n                      key={mode.id}\n                      className={`p-3 rounded-lg border ${\n                        isEnabled(mode.id as any)\n                          ? 'bg-primary/20 border-primary/50'\n                          : 'bg-background/50 border-primary/20'\n                      }`}\n                    >\n                      <p className=\"text-sm font-semibold\">{mode.label}</p>\n                      <p className=\"text-xs text-foreground/50 mt-1\">\n                        {isEnabled(mode.id as any) ? 'Active' : 'Inactive'}\n                      </p>\n                    </div>\n                  ))}\n                </div>\n              </div>\n            </Card>\n          </TabsContent>\n\n          {/* Notifications Tab */}\n          <TabsContent value=\"notifications\">\n            <Card className=\"glass-panel p-6\">\n              <h2 className=\"text-2xl font-bold mb-6 flex items-center gap-2\">\n                <Bell className=\"w-6 h-6\" />\n                Notification Preferences\n              </h2>\n              <div className=\"space-y-4\">\n                {[\n                  { id: 'emailNotifications', label: 'Email Notifications', description: 'Receive email updates' },\n                  { id: 'newAnimeAlerts', label: 'New Anime Alerts', description: 'Get notified of new releases' },\n                  {\n                    id: 'recommendationEmails',\n                    label: 'Recommendation Emails',\n                    description: 'Personalized anime suggestions',\n                  },\n                  { id: 'billingAlerts', label: 'Billing Alerts', description: 'Payment and subscription updates' },\n                ].map((pref) => (\n                  <div key={pref.id} className=\"flex items-center justify-between p-4 bg-background/50 rounded-lg border border-primary/20\">\n                    <div>\n                      <p className=\"font-semibold\">{pref.label}</p>\n                      <p className=\"text-sm text-foreground/60\">{pref.description}</p>\n                    </div>\n                    <Switch\n                      checked={notificationPrefs[pref.id as keyof typeof notificationPrefs]}\n                      onCheckedChange={(checked) =>\n                        setNotificationPrefs({ ...notificationPrefs, [pref.id]: checked })\n                      }\n                    />\n                  </div>\n                ))}\n              </div>\n              <Button className=\"w-full mt-6 bg-primary hover:bg-primary/90 text-background\">\n                Save Preferences\n              </Button>\n            </Card>\n          </TabsContent>\n\n          {/* Billing Tab */}\n          <TabsContent value=\"billing\">\n            <Card className=\"glass-panel p-6\">\n              <h2 className=\"text-2xl font-bold mb-6\">Billing & Subscription</h2>\n              {billing ? (\n                <div className=\"space-y-6\">\n                  {/* Current Plan */}\n                  <div className=\"p-4 bg-primary/10 rounded-lg border border-primary/20\">\n                    <p className=\"text-foreground/70 text-sm mb-2\">Current Plan</p>\n                    <p className=\"text-2xl font-bold text-primary capitalize\">{billing.subscription.tier}</p>\n                    <p className=\"text-sm text-foreground/60 mt-2\">\n                      Status: <span className=\"capitalize font-semibold\">{billing.subscription.status}</span>\n                    </p>\n                  </div>\n\n                  {/* Token Usage */}\n                  <div className=\"p-4 bg-accent/10 rounded-lg border border-accent/20\">\n                    <p className=\"text-foreground/70 text-sm mb-2\">Monthly Tokens</p>\n                    <div className=\"flex items-baseline gap-2\">\n                      <p className=\"text-2xl font-bold text-accent\">{billing.tokenUsage.tokensRemaining}</p>\n                      <p className=\"text-foreground/60\">/ {billing.tokenUsage.monthlyAllowance}</p>\n                    </div>\n                  </div>\n\n                  {/* Billing Period */}\n                  <div className=\"p-4 bg-background/50 rounded-lg border border-primary/20\">\n                    <p className=\"text-foreground/70 text-sm mb-2\">Billing Period</p>\n                    <p className=\"text-foreground\">\n                      {new Date(billing.subscription.currentPeriodStart).toLocaleDateString()} -{' '}\n                      {new Date(billing.subscription.currentPeriodEnd).toLocaleDateString()}\n                    </p>\n                  </div>\n\n                  {/* Actions */}\n                  <div className=\"flex gap-3\">\n                    <Button className=\"flex-1 bg-primary hover:bg-primary/90 text-background\">\n                      Update Payment Method\n                    </Button>\n                    <Button\n                      onClick={() => cancelSubscription()}\n                      className=\"flex-1 bg-red-500/20 hover:bg-red-500/30 text-red-400 border border-red-500/50\"\n                    >\n                      Cancel Subscription\n                    </Button>\n                  </div>\n                </div>\n              ) : (\n                <p className=\"text-foreground/70\">No active subscription</p>\n              )}\n            </Card>\n          </TabsContent>\n        </Tabs>\n      </section>\n    </div>\n  );\n}\n
